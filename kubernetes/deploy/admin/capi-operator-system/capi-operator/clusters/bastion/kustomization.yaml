apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
# resources:
# - github.com/kubernetes-sigs/cluster-api-operator//config/crd?ref=v0.7.0
# - externalsecret.yaml

helmCharts:
- name: cluster-api-operator
  repo: https://kubernetes-sigs.github.io/cluster-api-operator
  version: 0.7.0
  releaseName: capi-operator
  includeCRDs: true
  valuesInline:
    configSecret: {}

patches:
  - target:
      group: apiextensions.k8s.io
      kind: CustomResourceDefinition
    patch: |
      - op: add
        path: /metadata/annotations/argocd.argoproj.io~1sync-options
        value: Replace=true