apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../../base

patches:
- target:
    group: apps
    version: v1
    kind: DaemonSet
    namespace: node-feature-discovery
    name: nfd-topology-updater
  patch: |
    apiVersion: apps/v1
    kind: DaemonSet
    metadata:
      name: nfd-topology-updater
      namespace: node-feature-discovery
    spec:
      template:
        spec:
          volumes:
          - hostPath:
              path: /var/snap/microk8s/common/var/lib/kubelet/pod-resources/kubelet.sock
            name: kubelet-podresources-sock
          - hostPath:
              path: /var/snap/microk8s/common/var/lib/kubelet
            name: kubelet-state-files
